<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html xmlns="http://www.w3.org/1999/html" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<style>
		.marker{background-color: Yellow;}
	</style>
	<title>FOSSLight Hub</title>
</head>
<body>
<table cellspacing="0" cellpadding="0" border="0" style="font-family:'arial,sans-serif'">
	<tr>
		<td colspan="3" height="28" style="background:#f9f9f9"></td>
	</tr>
	<tr>
		<td width="60" style="background:#f9f9f9"></td>
		<td>
			<table cellspacing="0" cellpadding="0" border="0">
				<tr>
					<td colspan="3" height="25" style="background:#c00c3f">
						<h1 style="margin:0;padding-left:5px;font-size:14px;color:white">FOSSLight Hub Notification</h1>
					</td>
				</tr>
				<tr>
					<td width="1" style="background:#ddd"></td>
					<td style="padding:40px;">
						<div th:if="${contentsTitle != null && contentsTitle != ''}" style="padding-bottom:10px;font-size:16px;font-weight:bold;" th:utext="${contentsTitle}"></div>
						<p th:if="${contentsSubTitle != null && contentsSubTitle != ''}" style="font-size:12px;" th:utext="${contentsSubTitle}"></p>
						<h2 style="margin:20px 0 0;padding:10px;font-size:16px;">&laquo; Vulnerability Information &raquo;</h2>
						<table cellspacing="0" cellpadding="0" width="100%" border="1" style="font-size:12px;border-color:#ddd;">
							<th:block th:if="${vulnerability_oss_info}">
								<tr>
									<th style="padding:5px;background:#f0f0f0;">OSS ID</th>
									<th style="padding:5px;background:#f0f0f0;">OSS Name</th>
									<th style="padding:5px;background:#f0f0f0;">OSS Version</th>
									<th style="padding:5px;background:#f0f0f0;">CVE ID</th>
									<th style="padding:5px;background:#f0f0f0;">Score</th>
									<th style="padding:5px;background:#f0f0f0;">Summary</th>
									<th style="padding:5px;background:#f0f0f0;">Published Date</th>
									<th style="padding:5px;background:#f0f0f0;">Modified Date</th>
								</tr>

								<th:block th:each="vulnerability : ${vulnerability_oss_info}">
									<tr>
										<td style="padding:5px;" th:utext="${vulnerability.ossId}"></td>
										<td style="padding:5px;" th:utext="${vulnerability.ossName}"></td>
										<td style="padding:5px;" th:utext="${vulnerability.ossVersion}"></td>
										<td style="padding:5px;">
											<a th:if="${vulnerability.cveId}" th:href="${@CommonFunction.convertCveIdToLink(vulnerability.cveId)}"
											   th:utext="${vulnerability.cveId}"></a>
										</td>
										<td style="padding:5px;" th:utext="${vulnerability.cvssScore}"></td>
										<td style="padding:5px;" th:utext="${vulnerability.vulnSummary}"></td>
										<td style="padding:5px;" th:utext="${vulnerability.publishedDate}"></td>
										<td style="padding:5px;" th:utext="${vulnerability.modifiedDate}"></td>
									</tr>
								</th:block>
							</th:block>

							<th:block th:if="${vulnerability_diff_vendor_info}">
								<tr>
									<th style="padding:5px;background:#f0f0f0;">OSS Name</th>
									<th style="padding:5px;background:#f0f0f0;">CVE ID</th>
									<th style="padding:5px;background:#f0f0f0;">VENDOR (VENDOR-PRODUCT)</th>
								</tr>

								<th:block th:each="vendorInfo : ${vulnerability_diff_vendor_info}">
									<tr>
										<td style="padding:5px;" th:utext="${vendorInfo.product}"></td>
										<td style="padding:5px;">
											<a th:if="${vendorInfo.cveId}" th:href="${@CommonFunction.convertCveIdToLink(vendorInfo.cveId)}"
											   th:utext="${vendorInfo.cveId}"></a>
										</td>
										<td style="padding:5px;" th:utext="${vendorInfo.vendor}"></td>
									</tr>
								</th:block>
							</th:block>

						</table>
						<div style="margin:20px 0;border:1px dashed #666;"></div>
						<div th:with="shortDomain=${#strings.replace(domain, '(http|https)://', '')}"
							 style="font-size:12px;">
							* This mail was sent by <a th:href="${domain}" target="_blank" th:utext="${shortDomain}"></a>
						</div>
					</td>
					<td width="1" style="background:#ddd"></td>
				</tr>
				<tr>
					<td colspan="3" height="1" style="background:#ddd"></td>
				</tr>
			</table>
		</td>
		<td width="60" style="background:#f9f9f9"></td>
	</tr>
	<tr>
		<td colspan="3" height="28" style="background:#f9f9f9"></td>
	</tr>
</table>

</body>
</html>