package oss.fosslight.api.dto;

import lombok.Builder;
import lombok.Data;
import lombok.Getter;
import lombok.Setter;

import java.util.ArrayList;
import java.util.List;

import static oss.fosslight.common.CommonFunction.isEmpty;

@Data
public class VulnerabilityDto {
    private String cvdId;
    private String cvssScore;
    private String ossName;
    private String ossVersion;
    private String vendor;

    private String modified;
    private String ossNickname;

//    private String summary;
//    private String published;

    public void setVendor(String vendor) {
        List<String> replaceVendor = new ArrayList<>();
        for (String vendorNm : vendor.split(",")) {
            if (!isEmpty(vendorNm)) {
                replaceVendor.add(vendorNm);
            }
        }
        vendor = "";
        if (replaceVendor.size() > 0) {
            for (String reNm : replaceVendor) {
                vendor += reNm + ",";
            }
            this.vendor = vendor.substring(0, vendor.length()-1);
        } else {
            this.vendor = "";
        }
    }
}
