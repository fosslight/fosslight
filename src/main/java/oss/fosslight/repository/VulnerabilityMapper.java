/*
 * Copyright (c) 2021 LG Electronics Inc.
 * SPDX-License-Identifier: AGPL-3.0-only 
 */

package oss.fosslight.repository;

import java.util.List;
import java.util.Map;

import org.apache.ibatis.annotations.Mapper;

import oss.fosslight.domain.OssMaster;
import oss.fosslight.domain.Vulnerability;

@Mapper
public interface VulnerabilityMapper {

	int selectVulnerabilityTotalCount(Vulnerability vulnerability);
	
	List<Vulnerability> selectVulnerabilityList(Vulnerability vulnerability);
	
	int checkVulnDataCnt(Vulnerability vulnerability);
	
	List<String> selectVulnerabilityOSSNameAutoComplete();

	List<String> selectVulnerabilityOSSVersionAutoComplete(String name);

	List<String> selectVulnerabilityCveIdAutoComplete();
	
	int getVulnListByOssNameCnt(OssMaster bean);
	
	List<Vulnerability> getVulnListByOssName(OssMaster bean);

	int updateOssRecheckVulnFlag();

	int selectNvdTotalCount();

	Map<String, Object> selectNvdInfo(OssMaster ossBean);

	void insertNvdOssHis(OssMaster ossBean);

	void updateOssVulnInfoNew(OssMaster newNVD);

	List<String> selectUsedVulnerabilityOssProject(OssMaster ossBean);

	Map<String, Object> selectNvdInfoWithOutVer(OssMaster ossBean);

	void deleteOssVulnInfo(String ossId);
	
	List<Vulnerability> selectVulnerabilityExportList(Vulnerability vulnerability);

	Map<String, Object> getCveInfo(String cveId);

	List<Map<String, Object>> selectMaxScoreNvdInfo(Map<String, Object> paramMap);

}